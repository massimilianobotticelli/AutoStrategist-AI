resources:
  jobs:
    ingest_kaggle_data:
      name: "[${bundle.target}] Ingest Kaggle Data"
      tasks:
        - task_key: "load_data"
          environment_key: ingestion-env
          spark_python_task:
            python_file: "../autostrategist_ai/ingestion/load_data.py"            

        - task_key: "ingest_data"
          environment_key: ingestion-env
          depends_on:
            - task_key: load_data          
          spark_python_task:
            python_file: "../autostrategist_ai/ingestion/ingest_data.py"   

        - task_key: prepare_data
          environment_key: ingestion-env
          depends_on:
            - task_key: ingest_data
          spark_python_task:
            python_file: "../autostrategist_ai/ingestion/prepare_data.py"

        - task_key: car_models_clean
          environment_key: ingestion-env
          depends_on:
            - task_key: prepare_data
          spark_python_task:
            python_file: "../autostrategist_ai/ingestion/car_models_clean.py"

        - task_key: enrich_data
          environment_key: ingestion-env
          depends_on:
            - task_key: car_models_clean
          spark_python_task:
            python_file: "../autostrategist_ai/ingestion/enrich_data.py"

      environments:
        - environment_key: ingestion-env
          spec:
            client: "3"
            dependencies:
              - kaggle
              - databricks_langchain          

